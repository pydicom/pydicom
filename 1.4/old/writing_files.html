

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Writing DICOM Files &mdash; pydicom 1.4.0rc1 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/pydicom.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/pydicom.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Working with Pixel Data" href="working_with_pixel_data.html" />
    <link rel="prev" title="Core elements in pydicom" href="base_element.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> pydicom
          

          
            
            <img src="../_static/pydicom_flat_black.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1.4.0rc1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/installation.html">How to install pydicom</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Introduction to pydicom</a></li>
</ul>
<p class="caption"><span class="caption-text">Documentation</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="pydicom_user_guide.html">pydicom User Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="base_element.html">Core elements in pydicom</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Writing DICOM Files</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-the-codify-script">Using the Codify Script</a></li>
<li class="toctree-l3"><a class="reference internal" href="#writing-a-file-from-scratch">Writing a file from Scratch</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="working_with_pixel_data.html">Working with Pixel Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="working_with_overlays.html">Working with Overlay Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="image_data_handlers.html">Handling of compressed image data</a></li>
<li class="toctree-l2"><a class="reference internal" href="viewing_images.html">Viewing Images</a></li>
<li class="toctree-l2"><a class="reference internal" href="private_data_elements.html">Private Data Elements</a></li>
<li class="toctree-l2"><a class="reference internal" href="python2_support.html">Python 2 Support Plan for Pydicom</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ref_guide.html">Reading and writing DICOM files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/index.html">Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">API Reference</a></li>
</ul>
<p class="caption"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../auto_examples/index.html">General examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../auto_examples/index.html#image-processing">Image processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../auto_examples/index.html#input-output">Input-output</a></li>
<li class="toctree-l1"><a class="reference internal" href="../auto_examples/index.html#metadata-processing">Metadata processing</a></li>
</ul>
<p class="caption"><span class="caption-text">Additional Information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/contributing.html">Contributing to pydicom</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/index.html">Frequently asked questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release_notes/index.html">Release notes</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">pydicom</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="pydicom_user_guide.html">pydicom User Guide</a> &raquo;</li>
        
      <li>Writing DICOM Files</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="writing-dicom-files">
<span id="id1"></span><h1>Writing DICOM Files<a class="headerlink" href="#writing-dicom-files" title="Permalink to this headline">¶</a></h1>
<p class="rubric">How to write DICOM files using pydicom.</p>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Probably the most common use of pydicom is to read an existing DICOM file,
alter some items, and write it back out again. The first example in
<a class="reference internal" href="getting_started.html"><span class="doc">Introduction to pydicom</span></a> shows how to do this.</p>
<p>If you need to create a DICOM file from scratch, there are a couple of ways
of going about this: using the “codify” script, or creating a Dataset directly
and populating it.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>To be truly DICOM compliant, certain data elements will be required in the
file meta information, and in the main dataset. Also, you should create your
own UIDs, implementation name, and so on.</p>
</div>
</div>
<div class="section" id="using-the-codify-script">
<h2>Using the Codify Script<a class="headerlink" href="#using-the-codify-script" title="Permalink to this headline">¶</a></h2>
<p>In the pydicom ‘util’ folder, there is a script called <a class="reference external" href="https://github.com/pydicom/pydicom/blob/master/pydicom/util/codify.py">codify.py</a>.
It takes an existing DICOM file, and produces python code. The python code
uses pydicom to produce a copy of the original file again, when the code is
run.</p>
<p>In other words: pydicom has a tool that can automatically generate
well-designed python code for you - code that creates DICOM files. The only
requirement is that you have an existing DICOM file that looks approximately
like the one you need. You can then use the code as a model to work from. The
tool is especially useful with Sequences, which can be tricky to code
correctly.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The code produced by codify will contain all the information in the original
file, which may include private health information or other sensitive
information.  If the code is run, the resulting dicom file will also contain
that information. You may want to consider using de-identified dicom files
with codify, or handling the output files according to your requirements for
sensitive information.</p>
</div>
<p>One issue to be aware of is that codify will not create code for large items
like pixel data. Instead it creates a line like:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span><span class="o">.</span><span class="n">PixelData</span> <span class="o">=</span> <span class="c1"># XXX Array of 524288 bytes excluded</span>
</pre></div>
</div>
<p>In that case, the code will produce a syntax error when run, and you will have
to edit the code to supply a valid value.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The –exclude-size parameter can set the maximum size of the data
element value that is coded. Data elements bigger than that will have the
syntax error line as shown above.</p>
</div>
<p>One potential disadvantage of codify, depending on your use case, is that it
does not create loops. If you have, say, 30 items in a Sequence, codify will
produce code that makes them one at a time. Code you wrote by hand would
likely create them in a loop, because most of the code needed is quite
repetitive. If you want to switch to a loop, you could use the first item’s
code as a starting point, and modify as needed, deleting the code for the
other individual items.</p>
<p>Codify could also be called from code, rather than as a script; you can look
at the codify.py source and the <code class="docutils literal notranslate"><span class="pre">code_file</span></code> function for a starting point
for that.</p>
<p>To call codify as a script, use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">&lt;</span><span class="n">path</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">pydicom</span><span class="o">-</span><span class="n">util</span> <span class="n">folder</span><span class="o">&gt;/</span><span class="n">codify</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span><span class="n">s</span> <span class="n">savename</span> <span class="n">dicom</span><span class="o">-</span><span class="n">file</span> <span class="n">createdicomfile</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>The -s parameter is optional, but if present, is followed by a save filename
(the DICOM filename that would be created when the code is run). If not
specified, then a modified version of the input dicom filename is used. The
output file (createdicomfile.py in the example above) is optional.  If nothing
is specified, the code is written to standard output.</p>
<p>There is also a parameter <code class="docutils literal notranslate"><span class="pre">--exclude-private</span></code> if you don’t want private data
elements to be included in the generated code.</p>
<p>You can also call codify with <code class="docutils literal notranslate"><span class="pre">--help</span></code> to see details of all the parameters.</p>
</div>
<div class="section" id="writing-a-file-from-scratch">
<h2>Writing a file from Scratch<a class="headerlink" href="#writing-a-file-from-scratch" title="Permalink to this headline">¶</a></h2>
<p>The codify tool, described in the previous section, is a good starting point
for pydicom code, but if you can’t (or don’t want to) use that tool, then you
can certainly write code from scratch to make a complete DICOM file using
pydicom.</p>
<p>It’s not particularly difficult, but to produce a valid DICOM file requires
specific items to be created.  A basic example of that is available in the
example file <a class="reference internal" href="../auto_examples/input_output/plot_write_dicom.html#sphx-glr-auto-examples-input-output-plot-write-dicom-py"><span class="std std-ref">Write DICOM data</span></a>.</p>
<p>Just don’t forget the warnings in the Introduction section above, and be sure
to create all the required DICOM data elements.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="working_with_pixel_data.html" class="btn btn-neutral float-right" title="Working with Pixel Data" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="base_element.html" class="btn btn-neutral float-left" title="Core elements in pydicom" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2008-2019, Darcy Mason and pydicom contributors

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>