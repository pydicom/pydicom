

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>RLE Lossless Encoding &mdash; pydicom 2.2.0.dev0 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/pydicom.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/pydicom.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/pydicom.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery-dataframe.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery-rendered-html.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/clipboard.min.js"></script>
        <script src="../../_static/copybutton.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Encoder Plugins Options" href="encoder_plugin_options.html" />
    <link rel="prev" title="Pixel Data Encoding" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> pydicom
          

          
            
            <img src="../../_static/pydicom_flat_black.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                2.2.0.dev0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/installation.html">How to install pydicom</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../old/getting_started.html">Introduction to pydicom</a></li>
</ul>
<p class="caption"><span class="caption-text">Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../old/pydicom_user_guide.html">pydicom User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../old/ref_guide.html">Reading and writing DICOM files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Guides</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../element_value_types.html">Element VRs and Python types</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Pixel Data Encoding</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">RLE Lossless Encoding</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#valid-image-pixel-parameters">Valid Image Pixel Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#available-plugins">Available Plugins</a></li>
<li class="toctree-l4"><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="encoder_plugin_options.html">Encoder Plugins Options</a></li>
<li class="toctree-l3"><a class="reference internal" href="encoder_plugins.html">Pixel Data Encoder Plugins</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cli/cli_guide.html">Command-line Interface Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../glossary.html">Glossary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../writing_documentation.html">Writing documentation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/index.html">API Reference</a></li>
</ul>
<p class="caption"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../auto_examples/index.html">General examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../auto_examples/index.html#image-processing">Image processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../auto_examples/index.html#input-output">Input-output</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../auto_examples/index.html#metadata-processing">Metadata processing</a></li>
</ul>
<p class="caption"><span class="caption-text">Additional Information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/contributing.html">Contributing to pydicom</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq/index.html">Frequently asked questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release_notes/index.html">Release notes</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">pydicom</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">Guides</a> &raquo;</li>
        
          <li><a href="index.html">Pixel Data Encoding</a> &raquo;</li>
        
      <li>RLE Lossless Encoding</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="rle-lossless-encoding">
<h1>RLE Lossless Encoding<a class="headerlink" href="#rle-lossless-encoding" title="Permalink to this headline">¶</a></h1>
<p>The requirements for RLE encoding are defined in <a class="reference external" href="http://dicom.nema.org/medical/dicom/current/output/chtml/part05/sect_8.2.2.html">Section 8.2.2</a> and Annexes <a class="reference external" href="http://dicom.nema.org/medical/dicom/current/output/chtml/part05/sect_A.4.2.html">A.4.2</a>
and <a class="reference external" href="http://dicom.nema.org/medical/dicom/current/output/chtml/part05/chapter_G.html">G</a> of Part 5 of the DICOM Standard. The
underlying algorithm is based on the
<a class="reference external" href="https://en.wikipedia.org/wiki/PackBits">PackBits</a> compression scheme.</p>
<div class="section" id="valid-image-pixel-parameters">
<h2>Valid Image Pixel Parameters<a class="headerlink" href="#valid-image-pixel-parameters" title="Permalink to this headline">¶</a></h2>
<p>The table below lists the valid <a class="reference external" href="http://dicom.nema.org/medical/dicom/current/output/chtml/part03/sect_C.7.6.3.html">Image Pixel</a>
module parameters for <em>Pixel Data</em> encoded using <em>RLE Lossless</em> encoding. For
an explanation of each parameter and its relationship with the
<em>Pixel Data</em> see the <a class="reference internal" href="../glossary.html"><span class="doc">glossary of Image Pixel elements</span></a>.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 18%" />
<col style="width: 13%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><em>Samples
per Pixel</em></p></th>
<th class="head"><p><em>Photometric
Interpretation</em></p></th>
<th class="head"><p><em>Pixel
Representation</em></p></th>
<th class="head"><p><em>Bits
Allocated</em></p></th>
<th class="head"><p><em>Bits
Stored</em></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td rowspan="3"><p>1</p></td>
<td><p>MONOCHROME1</p></td>
<td rowspan="2"><p>0 or 1</p></td>
<td rowspan="3"><p>8 or 16</p></td>
<td rowspan="3"><p>1 to 16</p></td>
</tr>
<tr class="row-odd"><td><p>MONOCHROME2</p></td>
</tr>
<tr class="row-even"><td><p>PALETTE COLOR</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td rowspan="2"><p>3</p></td>
<td><p>RGB</p></td>
<td rowspan="2"><p>0</p></td>
<td><p>8 or 16</p></td>
<td><p>1 to 16</p></td>
</tr>
<tr class="row-even"><td><p>YBR_FULL</p></td>
<td><p>8</p></td>
<td><p>1 to 8</p></td>
</tr>
</tbody>
</table>
<p>To ensure you have the correct <em>Photometric Interpretation</em> when encoding using
<em>RLE Lossless</em>, the uncompressed pixel data should already be in the
corresponding color space:</p>
<ul class="simple">
<li><p>If your uncompressed pixel data is grayscale (intensity) based:</p>
<ul>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">MONOCHROME1</span></code> if the minimum intensity value should be displayed as
white.</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">MONOCHROME2</span></code> if the minimum intensity value should be displayed as
black.</p></li>
</ul>
</li>
<li><p>If your uncompressed pixel data uses a single sample per pixel and is an index
to the <a class="reference external" href="http://dicom.nema.org/medical/dicom/current/output/chtml/part03/sect_C.7.6.3.html#sect_C.7.6.3.1.5">Red, Green and Blue Palette Color Lookup Tables</a>:</p>
<ul>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">PALETTE</span> <span class="pre">COLOR</span></code>.</p></li>
</ul>
</li>
<li><p>If your uncompressed pixel data is in RGB color space:</p>
<ul>
<li><p>For <em>Photometric Interpretation</em> <code class="docutils literal notranslate"><span class="pre">RGB</span></code> nothing else is required.</p></li>
<li><p>For <em>Photometric Interpretation</em> <code class="docutils literal notranslate"><span class="pre">YBR_FULL</span></code></p>
<ul>
<li><p>For <em>Bits Allocated</em> and <em>Bits Stored</em> less than or equal to 8: pixel
data must be <a class="reference internal" href="../../reference/generated/pydicom.pixel_data_handlers.convert_color_space.html#pydicom.pixel_data_handlers.convert_color_space" title="pydicom.pixel_data_handlers.convert_color_space"><code class="xref py py-func docutils literal notranslate"><span class="pre">converted</span> <span class="pre">into</span> <span class="pre">YCbCr</span> <span class="pre">color</span> <span class="pre">space</span></code></a>. However
you should keep in mind that the conversion operation is lossy.</p></li>
<li><p>For <em>Bits Allocated</em> and <em>Bits Stored</em> between 9 and 16 (inclusive):
pixel data should be downscaled to 8-bit (with <em>Bits Stored</em>, <em>Bits
Allocated</em> and <em>High Bit</em> updated accordingly) and converted to <a class="reference external" href="https://en.wikipedia.org/wiki/YCbCr">YCbCr</a> color space. Both of these
operations are lossy.</p></li>
</ul>
</li>
</ul>
</li>
<li><p>If your uncompressed pixel data is in <a class="reference external" href="https://en.wikipedia.org/wiki/YCbCr">YCbCr</a> color space:</p>
<ul>
<li><p>For <em>Photometric Interpretation</em> <code class="docutils literal notranslate"><span class="pre">RGB</span></code> the pixel data must first be
<a class="reference internal" href="../../reference/generated/pydicom.pixel_data_handlers.convert_color_space.html#pydicom.pixel_data_handlers.convert_color_space" title="pydicom.pixel_data_handlers.convert_color_space"><code class="xref py py-func docutils literal notranslate"><span class="pre">converted</span> <span class="pre">into</span> <span class="pre">RGB</span> <span class="pre">color</span> <span class="pre">space</span></code></a>. However the conversion
operation is lossy.</p></li>
<li><p>For <em>Photometric Interpretation</em> <code class="docutils literal notranslate"><span class="pre">YBR_FULL</span></code> nothing else is required.</p></li>
</ul>
</li>
</ul>
<p>If a change is made to existing <em>Pixel Data</em>, such as conversion to a different
color space or downsampling to 8-bit then a new <em>SOP Instance UID</em> should be
generated.</p>
<p>You might be asking why you would convert uncompressed RGB pixel data to YCbCr
(or vice versa) if the conversion itself is lossy. The answer is that
using YCbCr data should result in a higher compression ratio than
with RGB, while YCbCr data is usually converted back to RGB before viewing.
The decision to change the color space should be made with the intended
usage of your dataset in mind.</p>
</div>
<div class="section" id="available-plugins">
<h2>Available Plugins<a class="headerlink" href="#available-plugins" title="Permalink to this headline">¶</a></h2>
<table class="docutils align-default">
<colgroup>
<col style="width: 37%" />
<col style="width: 8%" />
<col style="width: 32%" />
<col style="width: 4%" />
<col style="width: 19%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Encoder</p></th>
<th class="head" colspan="4"><p>Plugins</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Name</p></th>
<th class="head"><p>Requires</p></th>
<th class="head"><p>Added</p></th>
<th class="head"><p>Known Limitations</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td rowspan="3"><p><a class="reference internal" href="../../reference/generated/pydicom.encoders.RLELosslessEncoder.html#pydicom.encoders.RLELosslessEncoder" title="pydicom.encoders.RLELosslessEncoder"><code class="xref py py-attr docutils literal notranslate"><span class="pre">RLELosslessEncoder</span></code></a></p></td>
<td><p>pydicom</p></td>
<td></td>
<td><p>v2.2</p></td>
<td><p>~20x slower to encode</p></td>
</tr>
<tr class="row-even"><td><p>pylibjpeg</p></td>
<td><p><a class="reference internal" href="../../tutorials/installation.html#tut-install-np"><span class="std std-ref">NumPy</span></a>,
<a class="reference internal" href="../../tutorials/installation.html#tut-install-pylj"><span class="std std-ref">pylibjpeg</span></a>,
<a class="reference internal" href="../../tutorials/installation.html#tut-install-pylj"><span class="std std-ref">pylibjpeg-rle</span></a></p></td>
<td><p>v2.2</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>gdcm</p></td>
<td><p><a class="reference internal" href="../../tutorials/installation.html#tut-install-gdcm"><span class="std std-ref">GDCM</span></a></p></td>
<td><p>v2.2</p></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<p>Compressing grayscale pixel data in-place:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pydicom.data</span> <span class="kn">import</span> <span class="n">get_testdata_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pydicom.uid</span> <span class="kn">import</span> <span class="n">RLELossless</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ds</span> <span class="o">=</span> <span class="n">get_testdata_file</span><span class="p">(</span><span class="s2">&quot;CT_small.dcm&quot;</span><span class="p">,</span> <span class="n">read</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ds</span><span class="o">.</span><span class="n">SamplesPerPixel</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ds</span><span class="o">.</span><span class="n">PhotometricInterpretation</span>
<span class="go">&#39;MONOCHROME2&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ds</span><span class="o">.</span><span class="n">BitsAllocated</span>
<span class="go">16</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ds</span><span class="o">.</span><span class="n">PixelRepresentation</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ds</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="n">RLELossless</span><span class="p">)</span>
</pre></div>
</div>
<p>Compressing RGB pixel data in-place:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ds</span> <span class="o">=</span> <span class="n">get_testdata_file</span><span class="p">(</span><span class="s2">&quot;US1_UNCR.dcm&quot;</span><span class="p">,</span> <span class="n">read</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ds</span><span class="o">.</span><span class="n">SamplesPerPixel</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ds</span><span class="o">.</span><span class="n">PhotometricInterpretation</span>
<span class="go">&#39;RGB&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ds</span><span class="o">.</span><span class="n">BitsAllocated</span>
<span class="go">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ds</span><span class="o">.</span><span class="n">PixelRepresentation</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">PixelData</span><span class="p">)</span>
<span class="go">921600</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ds</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="n">RLELossless</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">PixelData</span><span class="p">)</span>
<span class="go">424152</span>
</pre></div>
</div>
<p>Convert RGB pixel data to YCbCr (requires <a class="reference internal" href="../../tutorials/installation.html#tut-install-np"><span class="std std-ref">NumPy</span></a>), then
compress in-place. Because the color space has changed we need to generate a
new <em>SOP Instance UID</em>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pydicom.pixel_data_handlers</span> <span class="kn">import</span> <span class="n">convert_color_space</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pydicom.uid</span> <span class="kn">import</span> <span class="n">generate_uid</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ds</span> <span class="o">=</span> <span class="n">get_testdata_file</span><span class="p">(</span><span class="s2">&quot;US1_UNCR.dcm&quot;</span><span class="p">,</span> <span class="n">read</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rgb</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">pixel_array</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ybr</span> <span class="o">=</span> <span class="n">convert_color_space</span><span class="p">(</span><span class="n">rgb</span><span class="p">,</span> <span class="s1">&#39;RGB&#39;</span><span class="p">,</span> <span class="s1">&#39;YBR_FULL&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ds</span><span class="o">.</span><span class="n">PhotometricInterpretation</span> <span class="o">=</span> <span class="s1">&#39;YBR_FULL&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ds</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="n">RLELossless</span><span class="p">,</span> <span class="n">ybr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ds</span><span class="o">.</span><span class="n">SOPInstanceUID</span> <span class="o">=</span> <span class="n">generate_uid</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">PixelData</span><span class="p">)</span>
<span class="go">187460</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="encoder_plugin_options.html" class="btn btn-neutral float-right" title="Encoder Plugins Options" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="index.html" class="btn btn-neutral float-left" title="Pixel Data Encoding" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2008-2021, Darcy Mason and pydicom contributors.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>